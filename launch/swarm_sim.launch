<launch>
  <!-- 中文说明：多机仿真启动文件（最多 6 台） -->
  <!-- 可调参数范围：agent_num 1~6，agent_type=0(UAV)/1(UGV) -->
  <!-- formation_policy: ring（推荐）；spacing > 0 -->
  <!-- 注意：agent_num 超过 6 需要手动扩展本文件 -->

  <arg name="agent_num" default="1"/>
  <arg name="agent_type" default="0"/>
  <arg name="leader_id" default="1"/>
  <arg name="agent_name" default="uav"/>
  <arg name="formation_policy" default="ring"/>
  <arg name="spacing" default="2.5"/>

  <arg name="neighborDist" default="1.5"/>
  <arg name="timeHorizon" default="2.0"/>
  <arg name="timeHorizonObst" default="2.0"/>
  <arg name="radius" default="0.3"/>
  <arg name="maxSpeed" default="0.5"/>
  <arg name="time_step" default="0.1"/>

  <arg name="geo_min_x" default="-5.0"/>
  <arg name="geo_max_x" default="5.0"/>
  <arg name="geo_min_y" default="-5.0"/>
  <arg name="geo_max_y" default="5.0"/>

  <!-- Expose agent_num globally so formation_tui can read it -->
  <param name="agent_num" value="$(arg agent_num)"/>

  <!-- agent 1 -->
  <group if="$(eval arg('agent_num') >= 1)">
    <include file="$(find sunray_swarm)/Agent_Swarm/launch/agent_swarm.launch">
      <arg name="agent_id" value="1"/>
      <arg name="agent_num" value="$(arg agent_num)"/>
      <arg name="agent_type" value="$(arg agent_type)"/>
      <arg name="leader_id" value="$(arg leader_id)"/>
      <arg name="agent_name" value="$(arg agent_name)"/>
      <arg name="formation_policy" value="$(arg formation_policy)"/>
      <arg name="spacing" value="$(arg spacing)"/>
      <arg name="node_name" value="agent_swarm_node_1"/>
    </include>
    <include file="$(find sunray_swarm)/ORCA/launch/orca.launch">
      <arg name="agent_id" value="1"/>
      <arg name="agent_num" value="$(arg agent_num)"/>
      <arg name="agent_name" value="$(arg agent_name)"/>
      <arg name="node_name" value="orca_node_1"/>
      <arg name="neighborDist" value="$(arg neighborDist)"/>
      <arg name="timeHorizon" value="$(arg timeHorizon)"/>
      <arg name="timeHorizonObst" value="$(arg timeHorizonObst)"/>
      <arg name="radius" value="$(arg radius)"/>
      <arg name="maxSpeed" value="$(arg maxSpeed)"/>
      <arg name="time_step" value="$(arg time_step)"/>
      <arg name="geo_min_x" value="$(arg geo_min_x)"/>
      <arg name="geo_max_x" value="$(arg geo_max_x)"/>
      <arg name="geo_min_y" value="$(arg geo_min_y)"/>
      <arg name="geo_max_y" value="$(arg geo_max_y)"/>
    </include>
  </group>

  <!-- agent 2 -->
  <group if="$(eval arg('agent_num') >= 2)">
    <include file="$(find sunray_swarm)/Agent_Swarm/launch/agent_swarm.launch">
      <arg name="agent_id" value="2"/>
      <arg name="agent_num" value="$(arg agent_num)"/>
      <arg name="agent_type" value="$(arg agent_type)"/>
      <arg name="leader_id" value="$(arg leader_id)"/>
      <arg name="agent_name" value="$(arg agent_name)"/>
      <arg name="formation_policy" value="$(arg formation_policy)"/>
      <arg name="spacing" value="$(arg spacing)"/>
      <arg name="node_name" value="agent_swarm_node_2"/>
    </include>
    <include file="$(find sunray_swarm)/ORCA/launch/orca.launch">
      <arg name="agent_id" value="2"/>
      <arg name="agent_num" value="$(arg agent_num)"/>
      <arg name="agent_name" value="$(arg agent_name)"/>
      <arg name="node_name" value="orca_node_2"/>
      <arg name="neighborDist" value="$(arg neighborDist)"/>
      <arg name="timeHorizon" value="$(arg timeHorizon)"/>
      <arg name="timeHorizonObst" value="$(arg timeHorizonObst)"/>
      <arg name="radius" value="$(arg radius)"/>
      <arg name="maxSpeed" value="$(arg maxSpeed)"/>
      <arg name="time_step" value="$(arg time_step)"/>
      <arg name="geo_min_x" value="$(arg geo_min_x)"/>
      <arg name="geo_max_x" value="$(arg geo_max_x)"/>
      <arg name="geo_min_y" value="$(arg geo_min_y)"/>
      <arg name="geo_max_y" value="$(arg geo_max_y)"/>
    </include>
  </group>

  <!-- agent 3 -->
  <group if="$(eval arg('agent_num') >= 3)">
    <include file="$(find sunray_swarm)/Agent_Swarm/launch/agent_swarm.launch">
      <arg name="agent_id" value="3"/>
      <arg name="agent_num" value="$(arg agent_num)"/>
      <arg name="agent_type" value="$(arg agent_type)"/>
      <arg name="leader_id" value="$(arg leader_id)"/>
      <arg name="agent_name" value="$(arg agent_name)"/>
      <arg name="formation_policy" value="$(arg formation_policy)"/>
      <arg name="spacing" value="$(arg spacing)"/>
      <arg name="node_name" value="agent_swarm_node_3"/>
    </include>
    <include file="$(find sunray_swarm)/ORCA/launch/orca.launch">
      <arg name="agent_id" value="3"/>
      <arg name="agent_num" value="$(arg agent_num)"/>
      <arg name="agent_name" value="$(arg agent_name)"/>
      <arg name="node_name" value="orca_node_3"/>
      <arg name="neighborDist" value="$(arg neighborDist)"/>
      <arg name="timeHorizon" value="$(arg timeHorizon)"/>
      <arg name="timeHorizonObst" value="$(arg timeHorizonObst)"/>
      <arg name="radius" value="$(arg radius)"/>
      <arg name="maxSpeed" value="$(arg maxSpeed)"/>
      <arg name="time_step" value="$(arg time_step)"/>
      <arg name="geo_min_x" value="$(arg geo_min_x)"/>
      <arg name="geo_max_x" value="$(arg geo_max_x)"/>
      <arg name="geo_min_y" value="$(arg geo_min_y)"/>
      <arg name="geo_max_y" value="$(arg geo_max_y)"/>
    </include>
  </group>

  <!-- agent 4 -->
  <group if="$(eval arg('agent_num') >= 4)">
    <include file="$(find sunray_swarm)/Agent_Swarm/launch/agent_swarm.launch">
      <arg name="agent_id" value="4"/>
      <arg name="agent_num" value="$(arg agent_num)"/>
      <arg name="agent_type" value="$(arg agent_type)"/>
      <arg name="leader_id" value="$(arg leader_id)"/>
      <arg name="agent_name" value="$(arg agent_name)"/>
      <arg name="formation_policy" value="$(arg formation_policy)"/>
      <arg name="spacing" value="$(arg spacing)"/>
      <arg name="node_name" value="agent_swarm_node_4"/>
    </include>
    <include file="$(find sunray_swarm)/ORCA/launch/orca.launch">
      <arg name="agent_id" value="4"/>
      <arg name="agent_num" value="$(arg agent_num)"/>
      <arg name="agent_name" value="$(arg agent_name)"/>
      <arg name="node_name" value="orca_node_4"/>
      <arg name="neighborDist" value="$(arg neighborDist)"/>
      <arg name="timeHorizon" value="$(arg timeHorizon)"/>
      <arg name="timeHorizonObst" value="$(arg timeHorizonObst)"/>
      <arg name="radius" value="$(arg radius)"/>
      <arg name="maxSpeed" value="$(arg maxSpeed)"/>
      <arg name="time_step" value="$(arg time_step)"/>
      <arg name="geo_min_x" value="$(arg geo_min_x)"/>
      <arg name="geo_max_x" value="$(arg geo_max_x)"/>
      <arg name="geo_min_y" value="$(arg geo_min_y)"/>
      <arg name="geo_max_y" value="$(arg geo_max_y)"/>
    </include>
  </group>

  <!-- agent 5 -->
  <group if="$(eval arg('agent_num') >= 5)">
    <include file="$(find sunray_swarm)/Agent_Swarm/launch/agent_swarm.launch">
      <arg name="agent_id" value="5"/>
      <arg name="agent_num" value="$(arg agent_num)"/>
      <arg name="agent_type" value="$(arg agent_type)"/>
      <arg name="leader_id" value="$(arg leader_id)"/>
      <arg name="agent_name" value="$(arg agent_name)"/>
      <arg name="formation_policy" value="$(arg formation_policy)"/>
      <arg name="spacing" value="$(arg spacing)"/>
      <arg name="node_name" value="agent_swarm_node_5"/>
    </include>
    <include file="$(find sunray_swarm)/ORCA/launch/orca.launch">
      <arg name="agent_id" value="5"/>
      <arg name="agent_num" value="$(arg agent_num)"/>
      <arg name="agent_name" value="$(arg agent_name)"/>
      <arg name="node_name" value="orca_node_5"/>
      <arg name="neighborDist" value="$(arg neighborDist)"/>
      <arg name="timeHorizon" value="$(arg timeHorizon)"/>
      <arg name="timeHorizonObst" value="$(arg timeHorizonObst)"/>
      <arg name="radius" value="$(arg radius)"/>
      <arg name="maxSpeed" value="$(arg maxSpeed)"/>
      <arg name="time_step" value="$(arg time_step)"/>
      <arg name="geo_min_x" value="$(arg geo_min_x)"/>
      <arg name="geo_max_x" value="$(arg geo_max_x)"/>
      <arg name="geo_min_y" value="$(arg geo_min_y)"/>
      <arg name="geo_max_y" value="$(arg geo_max_y)"/>
    </include>
  </group>

  <!-- agent 6 -->
  <group if="$(eval arg('agent_num') >= 6)">
    <include file="$(find sunray_swarm)/Agent_Swarm/launch/agent_swarm.launch">
      <arg name="agent_id" value="6"/>
      <arg name="agent_num" value="$(arg agent_num)"/>
      <arg name="agent_type" value="$(arg agent_type)"/>
      <arg name="leader_id" value="$(arg leader_id)"/>
      <arg name="agent_name" value="$(arg agent_name)"/>
      <arg name="formation_policy" value="$(arg formation_policy)"/>
      <arg name="spacing" value="$(arg spacing)"/>
      <arg name="node_name" value="agent_swarm_node_6"/>
    </include>
    <include file="$(find sunray_swarm)/ORCA/launch/orca.launch">
      <arg name="agent_id" value="6"/>
      <arg name="agent_num" value="$(arg agent_num)"/>
      <arg name="agent_name" value="$(arg agent_name)"/>
      <arg name="node_name" value="orca_node_6"/>
      <arg name="neighborDist" value="$(arg neighborDist)"/>
      <arg name="timeHorizon" value="$(arg timeHorizon)"/>
      <arg name="timeHorizonObst" value="$(arg timeHorizonObst)"/>
      <arg name="radius" value="$(arg radius)"/>
      <arg name="maxSpeed" value="$(arg maxSpeed)"/>
      <arg name="time_step" value="$(arg time_step)"/>
      <arg name="geo_min_x" value="$(arg geo_min_x)"/>
      <arg name="geo_max_x" value="$(arg geo_max_x)"/>
      <arg name="geo_min_y" value="$(arg geo_min_y)"/>
      <arg name="geo_max_y" value="$(arg geo_max_y)"/>
    </include>
  </group>
</launch>
